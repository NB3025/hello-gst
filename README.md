"# hello-gst" 

1. GST 탑홀더 크롤링
- GST 탑 홀더가 누구인지, 몇 개를 소유하고 있는지
- url
https://api.solscan.io/token/holders?token=AFbX8oGjGpmVFywbVouvhQSRmiW2aR1mohfahi4Y2AdB&offset=0&size=20
{"succcess":true,"data":{"total":8221,"result":[{"address":"HLS5Y68QSQgJP7wUbbbbCjEnMknVZrHXYDwwVaDcsdK7","amount":8632570317876128,"decimals":9,"owner":"STEPNq2UGeGSzCyGVr2nMQAzf8xuejwqebd84wcksCK","rank":1},{"address":"9r39vqrJuubgafaJ5aQyDWYAUQVJeyZyveBXeRqp7xev","amount":494146446748064,"decimals":9,"owner":"CwwMfXPXfRT5H5JUatpBctASRGhKW2SqLWWGU3eX5Zgo","rank":2},{"address":"FUhWxowvm2pQN57HDse6PbLQnjDhxRH4b1GkuzBk2rxJ","amount":83792520000000,"decimals":9,"owner":"CPmzWBRrY8DCnytvwEmxg6x96opzbcFAx7Dyc4CjXMur","rank":3},{"address":"GXty5E1WKvS7kyw69BgkAKAYw5eKk4ovwZrFEWYcacos","amount":50022888251339,"decimals":9,"owner":"3p9eikTKvQzAobZSn8iNuTSrnyimCcSknXvv2N8mXvLW","rank":4},{"address":"EFGR6UKFK6EENsJecp5p18v9NQz8NyYK8BN4MnbfGyvN","amount":22095789312872,"decimals":9,"owner":"z6AP5HXAbT83TGxeQzWUcyksrefFxDFwiT3V5qNwMVp","rank":5},{"address":"4xtTcg7NCWY6S6Pjh8Vr3z38PRhVfYCJqxgjB1naXc64","amount":16000607601490,"decimals":9,"owner":"4UrwVbb19wRGY3HkwQSYak4ZnbtV483meKkEAfuXdCSq","rank":6},{"address":"FCR6J27A8Wj399g1Ahb6SrxWYqN7V4tQmeSKhXhz8yNR","amount":14819883900929,"decimals":9,"owner":"7HP38CL3vdmf13MbJtsYajH8TxpehmBETQEJmDR1VMsZ","rank":7},{"address":"6DS7hrGejY7DCpVaKCQNST3C8KqLyaTe3GfnMVdSFXXt","amount":14042410125014,"decimals":9,"owner":"2hAYjbtGVhgnhjsou5SrySRHwK6bStN5VHVMXHWfyWZH","rank":8},{"address":"3a4gZpP1CfrGT31793V3QeApU8Qe4GwtxuswF5Tm2pNG","amount":12826683692069,"decimals":9,"owner":"Fo6DNeEbhWNZucHQ2ysJdxUJk4sVK4VmP1ERcnmd7Aq5","rank":9},{"address":"BwVyuHV2A8yiwegCnQa9hekNGHWjJmnUUfXhBMefkVxQ","amount":10480433945508,"decimals":9,"owner":"3VoDEqUQ3E9yKsBLPPBpaLDG5N1QSNnn7nHHKJ3Ejrv4","rank":10},{"address":"BaXd6Xj1ADj4Ku3JCCJDMhscfY29wvdj6k1Rc3UHp7yN","amount":10193572736019,"decimals":9,"owner":"BPssyJpjwjaAEpHcdktFrAfAoPs4gAAfYfHcwiNGzFGh","rank":11},{"address":"DPx8cgPaariN9SF6J8fntZXiddNrAmsBjsNEHMAeV9B1","amount":9590155017009,"decimals":9,"owner":"9jf3fRnp9272HModXHWyF96FY3kqAk2XqimFgyTPPtAN","rank":12},{"address":"6APn8hnXtKVNbck7uQiAwtzD4zxHkHLx2rVdutfNDHPd","amount":9100081704127,"decimals":9,"owner":"9iUfp34pGkYs9A6SnyABqPucwpDYNY1n3wSX1DzYX8xG","rank":13},{"address":"C3oFTvk1VGU7HKFroaqde4s4wzs4UCn4GhAkyPxoWFUp","amount":7933565231558,"decimals":9,"owner":"7wozBj12YGfg5CrrtNuuHXfnFzdBxjs5VzsMhbzooAuv","rank":14},{"address":"GaXifgJsU9UfKqmRBcTfLVmG9DCwQDEavskaZ2Q7Vr5v","amount":6893296052703,"decimals":9,"owner":"5Q544fKrFoe6tsEbD7S8EmxGTJYAKtTVhAW5Q5pge4j1","rank":15},{"address":"8MUnH2buF1NLDt1XLUPgtzJwi9cgrbvnvuKKrm3k6LAg","amount":6856201134947,"decimals":9,"owner":"JEGoTpJWTwMoRs1YAT3cc8emwPS1BipTTa4rrC9rHxYh","rank":16},{"address":"44rSmQSrfyPKxEQA17nY1gSBZffzihnWfdygpgaYeRzs","amount":6679769993661,"decimals":9,"owner":"5hqDuay5XUGC8abeNgTZWKAy3MZMmh57Lt5vACRxCsV3","rank":17},{"address":"5hWmo6eTUVuCdJFrV91z6bT6XxE4f7YTCpPZdGboQFr2","amount":6662007366609,"decimals":9,"owner":"6jLbQAsqHydXQoVXnbEjgqgzmJNey2ACDWPdeCcz4hYE","rank":18},{"address":"5j6S8rnf7soiDgAVbqWoNY5hjiktGHxbhTZq4LJWfT3J","amount":6435483842246,"decimals":9,"owner":"EHAHENVmzVJj9xGu7Rq5N1awPv3RgwM6SikwYLTeXFiS","rank":19},{"address":"5EtWWM7L8AXJZv1zojuRajmcg5Fz6w6i4xm28rsaMHLS","amount":5466772300429,"decimals":9,"owner":"B24dAHtYmYyQpXC5ENRKc4NBBDJtJUBgWExAM6HRPXCA","rank":20}]}}

2. 거래소 지갑 내 GST, USDC 개수 크롤링
- 거래소 지갑 내 GST와 USDC가 몇 개씩 변화는지 
https://api.solscan.io/account/tokens?address=CwwMfXPXfRT5H5JUatpBctASRGhKW2SqLWWGU3eX5Zgo&price=1

{"succcess":true,"data":[{"tokenAddress":"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v","tokenAmount":{"amount":"1328903373300","decimals":6,"uiAmount":1328903.3733,"uiAmountString":"1328903.3733"},"tokenAccount":"7LFnr5YgUyEgPMCLGNQ9N7wM5MFRNqCuRawLZTe5q4c7","tokenName":"USD Coin","tokenIcon":"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png","rentEpoch":279,"lamports":2039280,"tokenSymbol":"USDC","priceUsdt":1.001},{"tokenAddress":"E6UU5M1z4CvSAAF99d9wRoXsasWMEXsvHrz3JQRXtm2X","tokenAmount":{"amount":"420690000000","decimals":9,"uiAmount":420.69,"uiAmountString":"420.69"},"tokenAccount":"8D3fXYzmhpKDtLSfp8Jx3zJoGGQenFsV3LLvjasU8cCC","tokenName":"Dogelana","tokenIcon":"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/E6UU5M1z4CvSAAF99d9wRoXsasWMEXsvHrz3JQRXtm2X/logo.png","rentEpoch":279,"lamports":2039280,"tokenSymbol":"DGLN","priceUsdt":0.00001558},{"tokenAddress":"AFbX8oGjGpmVFywbVouvhQSRmiW2aR1mohfahi4Y2AdB","tokenAmount":{"amount":"494146446748064","decimals":9,"uiAmount":494146.446748064,"uiAmountString":"494146.446748064"},"tokenAccount":"9r39vqrJuubgafaJ5aQyDWYAUQVJeyZyveBXeRqp7xev","tokenName":"GST","tokenIcon":"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/AFbX8oGjGpmVFywbVouvhQSRmiW2aR1mohfahi4Y2AdB/logo.png","rentEpoch":279,"lamports":2039280,"tokenSymbol":"GST","priceUsdt":2.6973258527306445}]}

-> 위 데이터들을 DB에 저장한다.

DB 테이블
MariaDB [(none)]> use mysql

MariaDB [mysql]> update user SET password=password('') where user='root';
Query OK, 1 row affected (0.001 sec)
Rows matched: 1  Changed: 1  Warnings: 0

MariaDB [mysql]> flush privileges;
Query OK, 0 rows affected (0.000 sec)

MariaDB [(none)]> create database GST;
Query OK, 1 row affected (0.001 sec)

MariaDB [(none)]> create user 'STEPN'@'localhost' identified by '';
Query OK, 0 rows affected (0.000 sec)

MariaDB [(none)]> grant select,insert,delete,update on GST.* to 'STEPN'@'localhost';
Query OK, 0 rows affected (0.000 sec)

MariaDB [(none)]> show grants for 'STEPN'@'localhost';
+------------------------------------------------------------------------------------------------------+
| Grants for STEPN@%                                                                                   |
+------------------------------------------------------------------------------------------------------+
| GRANT USAGE ON *.* TO `STEPN`@`%` IDENTIFIED BY PASSWORD '*' |
| GRANT SELECT ON `GST`.* TO `STEPN`@`%`                                                               |
+------------------------------------------------------------------------------------------------------+
2 rows in set (0.000 sec)

MariaDB [(none)]> flush privileges;

테이블 생성은 root 계정으로 진행


1. GST 홀더 테이블

t_gst_holders
---------------------
index   |created_at         |data
1       |2022-02-14 15:34   | data

- 스키마
CREATE TABLE t_gst_holders(
    id INT NOT NULL AUTO_INCREMENT,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    data json,
    PRIMARY KEY(id)
);


t_token_amount
-----------------------
index   |time               |gst_amount     |usdc_amount
1       |2022-02-14 15:34   | 30            | 40

CREATE TABLE t_token_amount(\
    id INT NOT NULL AUTO_INCREMENT,\
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,\
    gst_amount INT,\
    usdc_amount INT,\
    PRIMARY KEY(id)\
);